CREATE TABLE IF NOT EXISTS note(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(100),
    text BYTEA
);

CREATE TABLE IF NOT EXISTS attachment(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    file BYTEA,
    extension VARCHAR(6)
);

ALTER TABLE attachment
ADD CONSTRAINT attachment_extension_constraint CHECK ( extension in ('PNG', 'JPEG', 'JPG', 'MP3', 'GIF'));

CREATE TABLE IF NOT EXISTS note_attachments(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    note_id INTEGER NOT NULL REFERENCES note(id),
    attachment_id INTEGER NOT NULL REFERENCES attachment(id)
);
